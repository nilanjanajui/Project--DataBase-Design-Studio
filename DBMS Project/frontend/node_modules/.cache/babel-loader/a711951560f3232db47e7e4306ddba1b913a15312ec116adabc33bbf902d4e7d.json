{"ast":null,"code":"var _jsxFileName = \"D:\\\\DBMS\\\\DBMS Project\\\\frontend\\\\src\\\\components\\\\ERDiagramPage.jsx\",\n  _s = $RefreshSig$();\nimport React, { useEffect, useState, useRef } from 'react';\nimport axios from 'axios';\nimport { useNavigate } from 'react-router-dom'; // <-- Import navigation hook\nimport { jsxDEV as _jsxDEV, Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nconst ERDiagramPage = () => {\n  _s();\n  const [imageURL, setImageURL] = useState(null);\n  const [error, setError] = useState(null);\n  const [scale, setScale] = useState(1);\n  const containerRef = useRef(null);\n  const imgRef = useRef(null);\n  const navigate = useNavigate(); // <-- Create navigate function\n  const pos = useRef({\n    x: 0,\n    y: 0,\n    isDragging: false,\n    startX: 0,\n    startY: 0\n  });\n  useEffect(() => {\n    const fetchERDiagram = async () => {\n      try {\n        const response = await axios.get('/api/get_er_diagram_image', {\n          responseType: 'blob'\n        });\n        const blobUrl = URL.createObjectURL(response.data);\n        setImageURL(blobUrl);\n      } catch (err) {\n        var _err$response, _err$response$data;\n        setError(((_err$response = err.response) === null || _err$response === void 0 ? void 0 : (_err$response$data = _err$response.data) === null || _err$response$data === void 0 ? void 0 : _err$response$data.message) || 'Failed to load ER Diagram');\n      }\n    };\n    fetchERDiagram();\n  }, []);\n\n  // Mouse wheel zoom\n  const handleWheel = e => {\n    e.preventDefault();\n    const zoomSpeed = 0.1;\n    if (e.deltaY < 0) {\n      setScale(prev => Math.min(prev + zoomSpeed, 5));\n    } else {\n      setScale(prev => Math.max(prev - zoomSpeed, 0.5));\n    }\n  };\n\n  // Drag start\n  const handleMouseDown = e => {\n    pos.current.isDragging = true;\n    pos.current.startX = e.clientX - pos.current.x;\n    pos.current.startY = e.clientY - pos.current.y;\n  };\n\n  // Drag move\n  const handleMouseMove = e => {\n    if (!pos.current.isDragging) return;\n    pos.current.x = e.clientX - pos.current.startX;\n    pos.current.y = e.clientY - pos.current.startY;\n    imgRef.current.style.transform = `translate(${pos.current.x}px, ${pos.current.y}px) scale(${scale})`;\n  };\n\n  // Drag end\n  const handleMouseUp = () => {\n    pos.current.isDragging = false;\n  };\n\n  // Reset zoom and position\n  const resetView = () => {\n    setScale(1);\n    pos.current = {\n      x: 0,\n      y: 0,\n      isDragging: false,\n      startX: 0,\n      startY: 0\n    };\n    imgRef.current.style.transform = `translate(0px, 0px) scale(1)`;\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"er-page\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"er-header\",\n      children: [/*#__PURE__*/_jsxDEV(\"button\", {\n        className: \"back-button\",\n        onClick: () => navigate(-1),\n        children: \"\\u2B05 Back\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 69,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"h2\", {\n        className: \"er-title\",\n        children: \"ER Diagram\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 70,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 68,\n      columnNumber: 7\n    }, this), error && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"er-error\",\n      children: error\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 73,\n      columnNumber: 17\n    }, this), imageURL && /*#__PURE__*/_jsxDEV(_Fragment, {\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"zoom-controls\",\n        children: /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: resetView,\n          children: \"Reset\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 77,\n          columnNumber: 13\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 76,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        ref: containerRef,\n        className: \"er-container\",\n        onWheel: handleWheel,\n        onMouseDown: handleMouseDown,\n        onMouseMove: handleMouseMove,\n        onMouseUp: handleMouseUp,\n        onMouseLeave: handleMouseUp,\n        children: /*#__PURE__*/_jsxDEV(\"img\", {\n          ref: imgRef,\n          src: imageURL,\n          alt: \"ER Diagram\",\n          className: \"er-image\",\n          style: {\n            transform: `translate(0px, 0px) scale(${scale})`\n          }\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 88,\n          columnNumber: 13\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 79,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 67,\n    columnNumber: 5\n  }, this);\n};\n_s(ERDiagramPage, \"nEoS+NyGqeKfbghgEfLjRCj7z+c=\", false, function () {\n  return [useNavigate];\n});\n_c = ERDiagramPage;\nexport default ERDiagramPage;\nvar _c;\n$RefreshReg$(_c, \"ERDiagramPage\");","map":{"version":3,"names":["React","useEffect","useState","useRef","axios","useNavigate","jsxDEV","_jsxDEV","Fragment","_Fragment","ERDiagramPage","_s","imageURL","setImageURL","error","setError","scale","setScale","containerRef","imgRef","navigate","pos","x","y","isDragging","startX","startY","fetchERDiagram","response","get","responseType","blobUrl","URL","createObjectURL","data","err","_err$response","_err$response$data","message","handleWheel","e","preventDefault","zoomSpeed","deltaY","prev","Math","min","max","handleMouseDown","current","clientX","clientY","handleMouseMove","style","transform","handleMouseUp","resetView","className","children","onClick","fileName","_jsxFileName","lineNumber","columnNumber","ref","onWheel","onMouseDown","onMouseMove","onMouseUp","onMouseLeave","src","alt","_c","$RefreshReg$"],"sources":["D:/DBMS/DBMS Project/frontend/src/components/ERDiagramPage.jsx"],"sourcesContent":["import React, { useEffect, useState, useRef } from 'react';\r\nimport axios from 'axios';\r\nimport { useNavigate } from 'react-router-dom'; // <-- Import navigation hook\r\n\r\nconst ERDiagramPage = () => {\r\n  const [imageURL, setImageURL] = useState(null);\r\n  const [error, setError] = useState(null);\r\n  const [scale, setScale] = useState(1);\r\n  const containerRef = useRef(null);\r\n  const imgRef = useRef(null);\r\n  const navigate = useNavigate(); // <-- Create navigate function\r\n  const pos = useRef({ x: 0, y: 0, isDragging: false, startX: 0, startY: 0 });\r\n\r\n  useEffect(() => {\r\n    const fetchERDiagram = async () => {\r\n      try {\r\n        const response = await axios.get('/api/get_er_diagram_image', { responseType: 'blob' });\r\n        const blobUrl = URL.createObjectURL(response.data);\r\n        setImageURL(blobUrl);\r\n      } catch (err) {\r\n        setError(err.response?.data?.message || 'Failed to load ER Diagram');\r\n      }\r\n    };\r\n\r\n    fetchERDiagram();\r\n  }, []);\r\n\r\n  // Mouse wheel zoom\r\n  const handleWheel = (e) => {\r\n    e.preventDefault();\r\n    const zoomSpeed = 0.1;\r\n    if (e.deltaY < 0) {\r\n      setScale((prev) => Math.min(prev + zoomSpeed, 5));\r\n    } else {\r\n      setScale((prev) => Math.max(prev - zoomSpeed, 0.5));\r\n    }\r\n  };\r\n\r\n  // Drag start\r\n  const handleMouseDown = (e) => {\r\n    pos.current.isDragging = true;\r\n    pos.current.startX = e.clientX - pos.current.x;\r\n    pos.current.startY = e.clientY - pos.current.y;\r\n  };\r\n\r\n  // Drag move\r\n  const handleMouseMove = (e) => {\r\n    if (!pos.current.isDragging) return;\r\n    pos.current.x = e.clientX - pos.current.startX;\r\n    pos.current.y = e.clientY - pos.current.startY;\r\n    imgRef.current.style.transform = `translate(${pos.current.x}px, ${pos.current.y}px) scale(${scale})`;\r\n  };\r\n\r\n  // Drag end\r\n  const handleMouseUp = () => {\r\n    pos.current.isDragging = false;\r\n  };\r\n\r\n  // Reset zoom and position\r\n  const resetView = () => {\r\n    setScale(1);\r\n    pos.current = { x: 0, y: 0, isDragging: false, startX: 0, startY: 0 };\r\n    imgRef.current.style.transform = `translate(0px, 0px) scale(1)`;\r\n  };\r\n\r\n  return (\r\n    <div className=\"er-page\">\r\n      <div className=\"er-header\">\r\n        <button className=\"back-button\" onClick={() => navigate(-1)}>â¬… Back</button>\r\n        <h2 className=\"er-title\">ER Diagram</h2>\r\n      </div>\r\n\r\n      {error && <div className=\"er-error\">{error}</div>}\r\n      {imageURL && (\r\n        <>\r\n          <div className=\"zoom-controls\">\r\n            <button onClick={resetView}>Reset</button>\r\n          </div>\r\n          <div\r\n            ref={containerRef}\r\n            className=\"er-container\"\r\n            onWheel={handleWheel}\r\n            onMouseDown={handleMouseDown}\r\n            onMouseMove={handleMouseMove}\r\n            onMouseUp={handleMouseUp}\r\n            onMouseLeave={handleMouseUp}\r\n          >\r\n            <img\r\n              ref={imgRef}\r\n              src={imageURL}\r\n              alt=\"ER Diagram\"\r\n              className=\"er-image\"\r\n              style={{\r\n                transform: `translate(0px, 0px) scale(${scale})`,\r\n              }}\r\n            />\r\n          </div>\r\n        </>\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default ERDiagramPage;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}